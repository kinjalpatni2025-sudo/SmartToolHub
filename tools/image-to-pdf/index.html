<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Image to PDF Converter — Smarttool Hub</title>
  <meta name="description" content="Convert JPG/PNG images to a single PDF or separate PDFs (ZIP). 100% client-side, drag & drop, reorder, preview and download." />
  <meta name="keywords" content="image to pdf, jpg to pdf, png to pdf, convert images to pdf, images to pdf online" />
  <link rel="icon" href="https://img.icons8.com/fluency/48/toolbox.png" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
  <style>
    :root{
      --bg:#0b1220; --text:#eaf2ff; --card:#182335; --border:#2a3b55; --primary:#22d3ee; --muted:#9fb3c8;
    }
    body.light{
      --bg:#f6f8fb; --text:#0b1220; --card:#fff; --border:#e6eefc; --primary:#0b74ff; --muted:#556677;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,system-ui,Arial;background:var(--bg);color:var(--text);transition:.22s}
    .container{max-width:1100px;margin:0 auto;padding:18px}
    header{display:flex;justify-content:space-between;align-items:center;background:var(--card);padding:12px;border-bottom:1px solid var(--border)}
    .brand a{display:flex;align-items:center;gap:12px;text-decoration:none;color:inherit}
    .brand img{width:46px;height:46px;border-radius:8px}
    .title{font-weight:700;color:var(--primary)}
    .tag{font-size:.85rem;color:var(--muted)}
    .header-actions{display:flex;gap:8px;align-items:center}
    .btn-header{border:1px solid var(--border);background:transparent;padding:8px 12px;border-radius:8px;color:var(--text);cursor:pointer;display:flex;gap:8px;align-items:center;text-decoration:none;font-weight:600}
    main{padding:18px 0}
    h1{margin:6px 0 8px;color:var(--primary)}
    .meta{color:var(--muted);margin-bottom:12px}
    .top{display:flex;gap:14px;flex-wrap:wrap}
    .uploader{flex:1;min-height:120px;border-radius:12px;border:2px dashed var(--border);display:flex;flex-direction:column;align-items:center;justify-content:center;padding:18px;background:var(--card);cursor:pointer}
    .uploader:hover{border-color:var(--primary)}
    input[type=file]{display:none}
    .controls{min-width:240px;display:flex;flex-direction:column;gap:10px}
    select,input[type=number]{padding:8px;border-radius:8px;border:1px solid var(--border);background:transparent;color:var(--text)}
    .preview{margin-top:18px;display:grid;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:12px}
    .thumb{background:var(--card);padding:8px;border-radius:10px;border:1px solid var(--border);position:relative;display:flex;flex-direction:column;align-items:center;gap:8px}
    .thumb img{max-width:100%;max-height:110px;border-radius:6px}
    .remove-btn{position:absolute;top:8px;right:8px;background:rgba(255,0,0,.75);color:#fff;border:none;border-radius:50%;width:26px;height:26px;cursor:pointer}
    .drag-handle{cursor:grab;color:var(--muted);font-size:14px}
    .progress{height:10px;background:var(--border);border-radius:999px;overflow:hidden;margin-top:12px}
    .progress-bar{height:100%;width:0;background:var(--primary);transition:width .2s}
    .actions{margin-top:12px;display:flex;gap:10px;flex-wrap:wrap}
    .btn{padding:10px 14px;border-radius:10px;border:none;cursor:pointer;font-weight:700}
    .btn-primary{background:var(--primary);color:#00131f}
    .btn-ghost{background:transparent;border:1px solid var(--border);color:var(--text)}
    .status{color:var(--muted);display:flex;align-items:center;gap:8px}
    .spinner{width:18px;height:18px;border-radius:50%;border:3px solid rgba(255,255,255,0.08);border-top-color:var(--primary);animation:spin .9s linear infinite}
    @keyframes spin{to{transform:rotate(360deg)}}
    footer{margin-top:24px;padding:12px 0;background:var(--card);border-top:1px solid var(--border)}
    @media(max-width:820px){.top{flex-direction:column}.controls{width:100%}}
  </style>
</head>
<body>
  <!-- Header -->
  <header class="container">
    <div class="brand">
      <a href="../../index.html" title="Back to Smarttool Hub">
        <img src="https://img.icons8.com/fluency/48/toolbox.png" alt="Smarttool Hub logo">
        <div>
          <div class="title">Smarttool Hub</div>
          <div class="tag">Fast • Private • Client-side</div>
        </div>
      </a>
    </div>
    <div class="header-actions">
      <a href="../../index.html" class="btn-header"><i class="fa-solid fa-house"></i> Home</a>
      <button id="themeToggle" class="btn-header" title="Toggle theme"><i class="fa-solid fa-moon"></i></button>
    </div>
  </header>

  <main class="container">
    <h1>Image → PDF Converter</h1>
    <div class="meta">Upload JPG/PNG images, reorder them, preview and download as one combined PDF or as separate PDFs (ZIP). All conversion happens in your browser — we never upload files.</div>

    <div class="top">
      <label class="uploader" id="uploader" title="Click or drop images">
        <div style="font-size:28px;color:var(--primary)"><i class="fa-solid fa-images"></i></div>
        <div style="margin-top:8px;font-weight:700">Click or drag & drop images here</div>
        <div style="margin-top:6px;color:var(--muted)">Supported: JPG, PNG, JPEG — multiple allowed</div>
        <input type="file" id="fileInput" accept="image/*" multiple />
      </label>

      <div class="controls">
        <div>
          <label for="pageSize" style="color:var(--muted);font-weight:700">Page size</label>
          <select id="pageSize">
            <option value="auto">Auto (image size)</option>
            <option value="a4">A4 (595 × 842 pt)</option>
            <option value="letter">Letter (612 × 792 pt)</option>
          </select>
        </div>

        <div>
          <label for="orientation" style="color:var(--muted);font-weight:700">Orientation</label>
          <select id="orientation">
            <option value="auto">Auto</option>
            <option value="portrait">Portrait</option>
            <option value="landscape">Landscape</option>
          </select>
        </div>

        <div>
          <label for="margin" style="color:var(--muted);font-weight:700">Margin (px)</label>
          <input id="margin" type="number" min="0" max="200" value="10" />
        </div>

        <div style="font-size:.9rem;color:var(--muted)">Tip: choose Auto to preserve original image resolution.</div>
      </div>
    </div>

    <div class="progress" aria-hidden="true"><div class="progress-bar" id="progressBar"></div></div>

    <div class="preview" id="preview" aria-live="polite"></div>

    <div class="actions">
      <button id="combineBtn" class="btn btn-primary" disabled><i class="fa-solid fa-file-arrow-down"></i> Combine into single PDF</button>
      <button id="separateZipBtn" class="btn btn-ghost" disabled><i class="fa-solid fa-file-zipper"></i> Download separate PDFs (ZIP)</button>
      <button id="clearBtn" class="btn btn-ghost" disabled><i class="fa-solid fa-trash-can"></i> Clear</button>
      <div class="status" id="status" aria-live="polite"></div>
    </div>

    <section style="margin-top:18px">
      <h2 style="color:var(--primary)">How it works</h2>
      <ol>
        <li>Click or drop images into the uploader.</li>
        <li>Reorder thumbnails by dragging them.</li>
        <li>Set page options and click <strong>Combine</strong> or <strong>Download separate PDFs</strong>.</li>
      </ol>
    </section>
  </main>

  <footer class="container">
    <div>© <span id="year"></span> Smarttool Hub</div>
    <div style="color:var(--muted)">Privacy • Terms • Contact</div>
  </footer>

  <!-- JSON-LD FAQ (SEO) -->
  <script type="application/ld+json">
  {"@context":"https://schema.org","@type":"FAQPage","mainEntity":[{"@type":"Question","name":"Is this free?","acceptedAnswer":{"@type":"Answer","text":"Yes — free to use and runs in your browser."}},{"@type":"Question","name":"Are my images uploaded?","acceptedAnswer":{"@type":"Answer","text":"No — all processing is client-side; we do not upload your files."}}]}
  </script>

  <!-- Libraries -->
  <script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

  <script>
  // ---------- Theme toggle + footer year ----------
  (function(){
    const btn = document.getElementById('themeToggle');
    if(localStorage.getItem('sth_theme') === 'light'){ document.body.classList.add('light'); btn.innerHTML = '<i class="fa-solid fa-sun"></i>'; }
    btn.addEventListener('click', () => {
      document.body.classList.toggle('light');
      if(document.body.classList.contains('light')){ btn.innerHTML = '<i class="fa-solid fa-sun"></i>'; localStorage.setItem('sth_theme','light'); }
      else { btn.innerHTML = '<i class="fa-solid fa-moon"></i>'; localStorage.removeItem('sth_theme'); }
    });
    document.getElementById('year').textContent = new Date().getFullYear();
  })();

  // ---------- References ----------
  const fileInput = document.getElementById('fileInput');
  const uploader = document.getElementById('uploader');
  const preview = document.getElementById('preview');
  const combineBtn = document.getElementById('combineBtn');
  const separateZipBtn = document.getElementById('separateZipBtn');
  const clearBtn = document.getElementById('clearBtn');
  const progressBar = document.getElementById('progressBar');
  const statusEl = document.getElementById('status');
  const pageSizeEl = document.getElementById('pageSize');
  const orientationEl = document.getElementById('orientation');
  const marginEl = document.getElementById('margin');

  // ---------- App state ----------
  // files = [{ id, file, url, width, height, name }]
  let files = [];

  // ---------- Helpers ----------
  function showStatus(text, busy=false, timeout=0){
    statusEl.textContent = text;
    if(busy){
      statusEl.insertAdjacentHTML('afterbegin','<span class="spinner" aria-hidden="true"></span>');
    }
    if(timeout>0) setTimeout(()=> statusEl.textContent = '', timeout);
  }
  function resetProgress(){ progressBar.style.width = '0%'; }
  function setProgress(p){ progressBar.style.width = Math.min(100, Math.max(0, Math.round(p))) + '%'; }
  function sanitize(name){ return name.replace(/[^a-z0-9_\-\.]/gi,'_'); }
  function triggerDownload(blob, filename){
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = filename;
    document.body.appendChild(a);
    a.click();
    a.remove();
    setTimeout(()=>URL.revokeObjectURL(a.href), 3000);
  }

  // ---------- Input & Drag & Drop ----------
  uploader.addEventListener('click', ()=> fileInput.click());
  uploader.addEventListener('dragover', e => { e.preventDefault(); uploader.style.borderColor = 'var(--primary)'; });
  uploader.addEventListener('dragleave', e => { uploader.style.borderColor = ''; });
  uploader.addEventListener('drop', e => {
    e.preventDefault();
    uploader.style.borderColor = '';
    handleFiles(e.dataTransfer.files);
  });
  fileInput.addEventListener('change', e => handleFiles(e.target.files));

  function handleFiles(fileList){
    const list = Array.from(fileList).filter(f => f.type && f.type.startsWith('image/'));
    if(list.length === 0) return;
    showStatus('Reading images...', true);
    const readers = list.map(file => new Promise(resolve => {
      const url = URL.createObjectURL(file);
      const img = new Image();
      img.onload = () => {
        const item = { id: Math.random().toString(36).slice(2,9), file, url, width: img.width, height: img.height, name: file.name };
        files.push(item);
        URL.revokeObjectURL(img.src); // revoke original temporary src? keep preview url separately
        resolve();
      };
      img.onerror = () => resolve(); // skip if error
      img.src = url;
    }));
    Promise.all(readers).then(()=> {
      renderPreview();
      showStatus('', false);
      updateButtons();
      fileInput.value = '';
    });
  }

  // ---------- Render thumbnails & drag reorder ----------
  function renderPreview(){
    preview.innerHTML = '';
    files.forEach((item, idx) => {
      const node = document.createElement('div');
      node.className = 'thumb';
      node.draggable = true;
      node.dataset.index = idx;
      node.innerHTML = `
        <button class="remove-btn" title="Remove" data-idx="${idx}">&times;</button>
        <div class="drag-handle" title="Drag to reorder"><i class="fa-solid fa-grip-lines"></i></div>
        <img src="${item.url}" alt="${escapeHtml(item.name)}">
        <div style="font-size:.9rem;color:var(--muted);text-align:center">${escapeHtml(item.name)}</div>
        <button class="btn btn-primary" style="margin-top:6px">Download PDF</button>
      `;
      // remove
      node.querySelector('.remove-btn').addEventListener('click', () => {
        // revoke object URL for this item
        try{ URL.revokeObjectURL(item.url); }catch(e){}
        files.splice(idx,1);
        renderPreview();
        updateButtons();
      });
      // download single PDF for this image
      node.querySelector('.btn-primary').addEventListener('click', () => downloadSinglePDF(idx));
      // drag events
      node.addEventListener('dragstart', (e) => {
        e.dataTransfer.setData('text/plain', idx.toString());
        e.dataTransfer.effectAllowed = 'move';
        node.style.opacity = '0.6';
      });
      node.addEventListener('dragend', () => node.style.opacity = '');
      node.addEventListener('dragover', (e) => { e.preventDefault(); e.dataTransfer.dropEffect = 'move'; });
      node.addEventListener('drop', (e) => {
        e.preventDefault();
        const from = Number(e.dataTransfer.getData('text/plain'));
        const to = Number(node.dataset.index);
        if(isNaN(from) || isNaN(to) || from===to) return;
        const item = files.splice(from,1)[0];
        files.splice(to,0,item);
        renderPreview();
      });
      preview.appendChild(node);
    });
  }

  function escapeHtml(s){ return String(s).replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])); }

  // ---------- Buttons state ----------
  function updateButtons(){
    const has = files.length>0;
    combineBtn.disabled = !has;
    separateZipBtn.disabled = !has;
    clearBtn.disabled = !has;
  }
  clearBtn.addEventListener('click', () => {
    files.forEach(f => { try{ URL.revokeObjectURL(f.url); }catch(e){} });
    files = [];
    renderPreview();
    updateButtons();
    resetProgress();
  });

  // ---------- PDF creation helpers ----------
  function getPageDimensionsFor(imgWidth, imgHeight, pageSize, orientation, margin){
    // page sizes in PDF points (approx) for a4 and letter
    const sizes = {
      a4: { w: 595, h: 842 },
      letter: { w: 612, h: 792 }
    };
    if(pageSize === 'a4' || pageSize === 'letter'){
      let w = sizes[pageSize].w, h = sizes[pageSize].h;
      if(orientation === 'portrait' && w > h){ [w,h] = [h,w]; }
      if(orientation === 'landscape' && h > w){ [w,h] = [h,w]; }
      return { pageW: w, pageH: h, maxW: w - margin*2, maxH: h - margin*2 };
    } else {
      // auto -> use image size as points (1px ~ 1pt approx; this preserves resolution)
      let pageW = imgWidth + margin*2;
      let pageH = imgHeight + margin*2;
      if(orientation === 'portrait' && pageW > pageH){ [pageW,pageH] = [pageH,pageW]; }
      if(orientation === 'landscape' && pageH > pageW){ [pageW,pageH] = [pageH,pageW]; }
      return { pageW, pageH, maxW: pageW - margin*2, maxH: pageH - margin*2 };
    }
  }

  // Combine into one multi-page PDF
  combineBtn.addEventListener('click', async () => {
    if(files.length === 0) return;
    showStatus('Creating PDF...', true);
    resetProgress();
    try{
      const pdfDoc = await PDFLib.PDFDocument.create();
      const pageSize = pageSizeEl.value;
      const orientation = orientationEl.value;
      const margin = Number(marginEl.value) || 0;

      for(let i=0;i<files.length;i++){
        const item = files[i];
        const arrayBuffer = await item.file.arrayBuffer();
        // embed JPG or PNG
        let embedded;
        const t = item.file.type || '';
        if(t.includes('jpeg') || t.includes('jpg')) embedded = await pdfDoc.embedJpg(arrayBuffer);
        else embedded = await pdfDoc.embedPng(arrayBuffer);

        // embedded.scale(1) returns dims
        const dims = embedded.scale(1);
        const { pageW, pageH, maxW, maxH } = getPageDimensionsFor(dims.width, dims.height, pageSize, orientation, margin);

        const page = pdfDoc.addPage([pageW, pageH]);
        // fit image into maxW x maxH while preserving aspect ratio
        const scale = Math.min(maxW / dims.width, maxH / dims.height, 1);
        const drawW = dims.width * scale;
        const drawH = dims.height * scale;
        const x = (pageW - drawW) / 2;
        const y = (pageH - drawH) / 2;
        page.drawImage(embedded, { x, y, width: drawW, height: drawH });

        setProgress(((i+1)/files.length)*100);
        // small delay to keep UI responsive on very large batches
        await new Promise(r => setTimeout(r, 30));
      }

      const pdfBytes = await pdfDoc.save();
      const blob = new Blob([pdfBytes], { type: 'application/pdf' });
      triggerDownload(blob, 'images_to_pdf.pdf');
      showStatus('Done ✓', false, 2500);
    } catch(err){
      console.error(err);
      showStatus('Conversion failed — see console', false);
    } finally {
      setTimeout(()=> resetProgress(), 800);
    }
  });

  // Download single image as a one-page PDF
  async function downloadSinglePDF(index){
    const item = files[index];
    showStatus('Preparing single PDF...', true);
    try{
      const pdfDoc = await PDFLib.PDFDocument.create();
      const arrayBuffer = await item.file.arrayBuffer();
      let embedded;
      const t = item.file.type || '';
      if(t.includes('jpeg') || t.includes('jpg')) embedded = await pdfDoc.embedJpg(arrayBuffer);
      else embedded = await pdfDoc.embedPng(arrayBuffer);
      const dims = embedded.scale(1);
      const margin = Number(marginEl.value) || 0;
      const { pageW, pageH } = getPageDimensionsFor(dims.width, dims.height, pageSizeEl.value, orientationEl.value, margin);
      const page = pdfDoc.addPage([pageW, pageH]);
      const drawW = dims.width;
      const drawH = dims.height;
      const x = (pageW - drawW) / 2;
      const y = (pageH - drawH) / 2;
      page.drawImage(embedded, { x, y, width: drawW, height: drawH });
      const pdfBytes = await pdfDoc.save();
      triggerDownload(new Blob([pdfBytes], { type: 'application/pdf' }), sanitize(item.name).replace(/\.[^/.]+$/, '') + '.pdf');
      showStatus('Done ✓', false, 1600);
    } catch(err){
      console.error(err);
      showStatus('Failed to create single PDF', false);
    }
  }

  // Create separate PDFs and zip them
  separateZipBtn.addEventListener('click', async () => {
    if(files.length === 0) return;
    showStatus('Creating PDFs & ZIP...', true);
    resetProgress();
    try{
      const zip = new JSZip();
      for(let i=0;i<files.length;i++){
        const item = files[i];
        const pdfDoc = await PDFLib.PDFDocument.create();
        const arrayBuffer = await item.file.arrayBuffer();
        let embedded;
        const t = item.file.type || '';
        if(t.includes('jpeg') || t.includes('jpg')) embedded = await pdfDoc.embedJpg(arrayBuffer);
        else embedded = await pdfDoc.embedPng(arrayBuffer);
        const dims = embedded.scale(1);
        const margin = Number(marginEl.value) || 0;
        const { pageW, pageH } = getPageDimensionsFor(dims.width, dims.height, pageSizeEl.value, orientationEl.value, margin);
        const page = pdfDoc.addPage([pageW, pageH]);
        page.drawImage(embedded, { x: margin, y: margin, width: dims.width, height: dims.height });
        const pdfBytes = await pdfDoc.save();
        zip.file(sanitize(item.name).replace(/\.[^/.]+$/, '') + '.pdf', pdfBytes);
        setProgress(((i+1)/files.length)*100);
        await new Promise(r => setTimeout(r,30));
      }

      const content = await zip.generateAsync({ type: 'blob' });
      triggerDownload(content, 'images_as_pdfs.zip');
      showStatus('ZIP ready ✓', false, 2000);
    } catch(err){
      console.error(err);
      showStatus('ZIP creation failed', false);
    } finally {
      setTimeout(()=> resetProgress(), 700);
    }
  });

  // ---------- initialize buttons ----------
  updateButtons();
  resetProgress();

  </script>
</body>
</html>
