<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>PDF to Image — Convert PDF pages to PNG/JPG Online (Client-side)</title>
<meta name="description" content="Convert PDF pages to PNG or JPG images in your browser. Convert single page or all pages, preview thumbnails, download individually or bulk ZIP. 100% client-side."/>
<meta name="keywords" content="PDF to image, pdf to png, pdf to jpg, convert pdf to image, pdf page to image, online pdf to jpg, pdf to png converter"/>
<link rel="icon" href="https://img.icons8.com/fluency/48/pdf.png"/>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"/>
<!-- JSZip for bulk zip download -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
<!-- pdf.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
<script>pdfjsLib.GlobalWorkerOptions.workerSrc='https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.worker.min.js';</script>

<style>
:root{
  --bg:#0b1220; --card:#142130; --text:#eaf2ff; --muted:#9fb3c8; --accent:#22d3ee; --border:#223248;
}
body.light{--bg:#f6f8fb;--card:#fff;--text:#0b1220;--muted:#556677;--accent:#0b74ff;--border:#e6eefc}
*{box-sizing:border-box}
body{margin:0;font-family:Inter,system-ui,Arial;background:var(--bg);color:var(--text);transition:.18s}
.container{max-width:1200px;margin:0 auto;padding:18px}
header{display:flex;justify-content:space-between;align-items:center;background:var(--card);padding:12px;border-bottom:1px solid var(--border)}
.brand a{display:flex;gap:12px;align-items:center;text-decoration:none;color:inherit}
.brand img{width:46px;height:46px;border-radius:8px}
.title{font-weight:700;color:var(--accent)}
.tag{font-size:.85rem;color:var(--muted)}
.header-actions{display:flex;gap:8px;align-items:center}
.btn-header{border:1px solid var(--border);background:transparent;padding:8px 12px;border-radius:8px;color:var(--text);cursor:pointer;display:flex;gap:8px;align-items:center;text-decoration:none;font-weight:600}

main{padding:18px 0}
.tools{display:flex;gap:12px;flex-wrap:wrap;align-items:center}
.uploader{flex:1;min-height:110px;border-radius:12px;border:2px dashed var(--border);display:flex;flex-direction:column;align-items:center;justify-content:center;padding:18px;background:var(--card);cursor:pointer}
.uploader:hover{border-color:var(--accent)}
input[type=file]{display:none}
.controls{display:flex;gap:10px;flex-wrap:wrap;align-items:center;margin-top:12px}
.controls select, .controls input[type=number]{padding:8px;border-radius:8px;border:1px solid var(--border);background:transparent;color:var(--text)}
.controls label{color:var(--muted);font-size:.95rem}
.btn{padding:10px 14px;border-radius:8px;border:none;cursor:pointer;font-weight:700}
.btn-primary{background:var(--accent);color:#00131f}
.preview-area{margin-top:18px;background:var(--card);padding:12px;border-radius:10px;border:1px solid var(--border)}
.preview-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:12px}
.thumb{background:#fff;border-radius:8px;padding:8px;display:flex;flex-direction:column;align-items:center;gap:8px;border:1px solid var(--border)}
.thumb img{max-width:100%;height:auto;border-radius:4px;display:block}
.thumb .meta{font-size:.85rem;color:#333;word-break:break-all}
.progress{height:10px;background:var(--border);border-radius:999px;overflow:hidden;margin-top:10px}
.progress-bar{height:100%;width:0;background:var(--accent);transition:width .2s}
.status{margin-top:8px;color:var(--muted)}
footer{margin-top:24px;padding:12px 0;background:var(--card);border-top:1px solid var(--border);text-align:center;color:var(--muted);font-size:.9rem}

/* responsive */
@media(max-width:760px){ .tools{flex-direction:column} .controls{width:100%} .uploader{width:100%} }
</style>
</head>
<body>
<header class="container">
  <div class="brand">
    <a href="../../index.html" title="home">
      <img src="https://img.icons8.com/fluency/48/pdf.png" alt="logo">
      <div>
        <div class="title">Smarttool Hub</div>
        <div class="tag">PDF → Image • Client-side</div>
      </div>
    </a>
  </div>
  <div class="header-actions">
    <a href="../../index.html" class="btn-header" title="Home"><i class="fa-solid fa-house"></i></a>
    <button id="themeBtn" class="btn-header" title="Toggle theme"><i id="themeIcon" class="fa-solid fa-moon"></i></button>
  </div>
</header>

<main class="container">
  <h1 style="color:var(--accent);margin:10px 0">PDF to Image Converter</h1>
  <p style="color:var(--muted)">Convert each PDF page to PNG or JPG images in your browser. Preview thumbnails, download single pages, or download all images as a ZIP file.</p>

  <div class="tools">
    <label id="dropZone" class="uploader" title="Click or drop PDF">
      <div style="font-size:26px;color:var(--accent)"><i class="fa-solid fa-file-pdf"></i></div>
      <div style="font-weight:700;margin-top:6px">Click or drag & drop a PDF here</div>
      <div style="color:var(--muted);margin-top:6px;font-size:.95rem">Supports multi-page PDF. Files stay in your browser.</div>
      <input id="fileInput" type="file" accept="application/pdf"/>
    </label>

    <div class="controls" aria-hidden="false">
      <label>Format:
        <select id="formatSelect">
          <option value="png">PNG (lossless)</option>
          <option value="jpg">JPG (lossy)</option>
        </select>
      </label>

      <label id="qualityLabel" style="display:none">JPG Quality:
        <input id="jpgQuality" type="number" min="0.1" max="1" step="0.1" value="0.9" style="width:88px"/>
      </label>

      <label>Scale (zoom):
        <input id="scaleInput" type="number" min="0.5" max="3" step="0.1" value="1.5" style="width:88px"/>
      </label>

      <label>Pages:
        <input id="pagesInput" type="text" placeholder="e.g. 1-3,5 or leave blank for all" style="width:170px;padding:8px;border-radius:8px;border:1px solid var(--border);background:transparent;color:var(--text)"/>
      </label>

      <button id="convertBtn" class="btn btn-primary"><i class="fa-solid fa-image"></i> Convert</button>
      <button id="downloadAllBtn" class="btn" disabled><i class="fa-solid fa-file-zipper"></i> Download All (.zip)</button>
    </div>
  </div>

  <div class="progress" aria-hidden="false"><div class="progress-bar" id="globalProgress"></div></div>
  <div class="status" id="status">No file selected.</div>

  <div class="preview-area" id="previewArea" style="display:none">
    <h3 style="margin:6px 0;color:var(--accent)">Preview & Downloads</h3>
    <div class="preview-grid" id="thumbs"></div>
  </div>
</main>

<footer class="container">
  <div>© <span id="year"></span> Smarttool Hub</div>
  <div style="color:var(--muted)">Privacy • Terms • Contact</div>
</footer>

<script>
/* ============================
   PDF → Image Converter (client-side)
   Uses pdf.js + JSZip (for zip)
   ============================ */

/* DOM refs */
const fileInput = document.getElementById('fileInput');
const dropZone = document.getElementById('dropZone');
const convertBtn = document.getElementById('convertBtn');
const thumbs = document.getElementById('thumbs');
const previewArea = document.getElementById('previewArea');
const statusEl = document.getElementById('status');
const progressBar = document.getElementById('globalProgress');
const formatSelect = document.getElementById('formatSelect');
const jpgQuality = document.getElementById('jpgQuality');
const qualityLabel = document.getElementById('qualityLabel');
const scaleInput = document.getElementById('scaleInput');
const pagesInput = document.getElementById('pagesInput');
const downloadAllBtn = document.getElementById('downloadAllBtn');
document.getElementById('year').textContent = new Date().getFullYear();

/* Theme */
const themeBtn = document.getElementById('themeBtn');
const themeIcon = document.getElementById('themeIcon');
if(localStorage.getItem('sth_theme') === 'light'){ document.body.classList.add('light'); themeIcon.className='fa-solid fa-sun'; }
themeBtn.addEventListener('click', ()=> {
  document.body.classList.toggle('light');
  if(document.body.classList.contains('light')){ localStorage.setItem('sth_theme','light'); themeIcon.className='fa-solid fa-sun'; }
  else { localStorage.removeItem('sth_theme'); themeIcon.className='fa-solid fa-moon'; }
});

/* State */
let pdfDoc = null;
let fileName = '';
let generatedImages = []; // {page, dataUrl, blob, name}

/* Drag & drop + file select */
dropZone.addEventListener('click', ()=> fileInput.click());
dropZone.addEventListener('dragover', e=> { e.preventDefault(); dropZone.style.borderColor = 'var(--accent)'; });
dropZone.addEventListener('dragleave', e=> { dropZone.style.borderColor = ''; });
dropZone.addEventListener('drop', e=> { e.preventDefault(); dropZone.style.borderColor = ''; handleFile(e.dataTransfer.files[0]); });
fileInput.addEventListener('change', e => handleFile(e.target.files[0]));

/* UI */
formatSelect.addEventListener('change', ()=> {
  if(formatSelect.value === 'jpg'){ qualityLabel.style.display = 'inline-block'; } else { qualityLabel.style.display = 'none'; }
});

/* Parse pages input string like "1-3,5,7-8" -> array of 1-based page numbers */
function parsePagesInput(str, maxPage){
  if(!str || !str.trim()) return Array.from({length: maxPage}, (_,i)=>i+1);
  const parts = str.split(',').map(s=>s.trim()).filter(Boolean);
  const pages = new Set();
  for(const p of parts){
    if(p.includes('-')){
      const [a,b] = p.split('-').map(x=>parseInt(x,10)).filter(n=>!isNaN(n));
      if(a && b){
        for(let i=Math.max(1,a); i<=Math.min(b,maxPage); i++) pages.add(i);
      }
    } else {
      const n = parseInt(p,10);
      if(!isNaN(n) && n>=1 && n<=maxPage) pages.add(n);
    }
  }
  return Array.from(pages).sort((a,b)=>a-b);
}

/* File handler */
async function handleFile(file){
  if(!file) return;
  if(!file.name.toLowerCase().endsWith('.pdf')){ alert('Please select a PDF file'); return; }
  fileName = file.name.replace(/\.pdf$/i,'');
  statusEl.textContent = `Loading ${file.name}...`;
  setProgress(3);
  try{
    const arrayBuffer = await file.arrayBuffer();
    pdfDoc = await pdfjsLib.getDocument({data: arrayBuffer}).promise;
    statusEl.textContent = `Loaded: ${file.name} — ${pdfDoc.numPages} page(s)`;
    setProgress(10);
    thumbs.innerHTML = '';
    generatedImages = [];
    previewArea.style.display = 'none';
    downloadAllBtn.disabled = true;
  }catch(err){
    console.error(err);
    alert('Failed to load PDF — see console for details.');
    setProgress(0);
    statusEl.textContent = 'Load failed.';
  }
}

/* Convert */
convertBtn.addEventListener('click', async ()=>{
  if(!pdfDoc){ alert('Please select a PDF first'); return; }
  const maxPage = pdfDoc.numPages;
  const pagesToConvert = parsePagesInput(pagesInput.value, maxPage);
  if(pagesToConvert.length === 0){ alert('No pages selected (check Pages input).'); return; }
  const fmt = formatSelect.value;
  const jpgQ = Math.max(0.1, Math.min(1, parseFloat(jpgQuality.value) || 0.9));
  const scale = Math.max(0.5, Math.min(3, parseFloat(scaleInput.value) || 1.5));
  thumbs.innerHTML = '';
  generatedImages = [];
  previewArea.style.display = 'block';
  setProgress(2);
  statusEl.textContent = `Converting ${pagesToConvert.length} page(s)...`;
  downloadAllBtn.disabled = true;

  for(let i=0;i<pagesToConvert.length;i++){
    const p = pagesToConvert[i];
    try{
      setProgress(5 + (i / pagesToConvert.length) * 80);
      const page = await pdfDoc.getPage(p);
      const viewport = page.getViewport({ scale: scale });
      const canvas = document.createElement('canvas');
      const ctx = canvas.getContext('2d');
      canvas.width = Math.round(viewport.width);
      canvas.height = Math.round(viewport.height);
      // white background for JPG compatibility
      ctx.fillStyle = '#fff';
      ctx.fillRect(0,0,canvas.width,canvas.height);
      await page.render({ canvasContext: ctx, viewport }).promise;
      // produce Data URL
      let dataUrl;
      if(fmt === 'png') dataUrl = canvas.toDataURL('image/png');
      else dataUrl = canvas.toDataURL('image/jpeg', jpgQ);
      // convert dataURL -> blob
      const blob = dataURLToBlob(dataUrl);
      const imgName = `${fileName}_page-${String(p).padStart(3,'0')}.${fmt === 'png' ? 'png' : 'jpg'}`;
      generatedImages.push({page: p, dataUrl, blob, name: imgName, width: canvas.width, height: canvas.height});
      // show thumb
      addThumb({page:p, dataUrl, name: imgName, width: canvas.width, height: canvas.height, blob});
    }catch(err){
      console.error('Convert page error', p, err);
      // continue but mark error
      const eDiv = document.createElement('div');
      eDiv.className = 'thumb';
      eDiv.innerHTML = `<div style="color:#900;font-weight:700">Page ${p} failed</div>`;
      thumbs.appendChild(eDiv);
    }
  }

  setProgress(100);
  statusEl.textContent = `Converted ${generatedImages.length}/${pagesToConvert.length} pages.`;
  downloadAllBtn.disabled = generatedImages.length === 0;
  // small delay to reset progress UI
  setTimeout(()=> setProgress(0), 600);
});

/* Add thumbnail card */
function addThumb({page, dataUrl, name, width, height, blob}){
  const div = document.createElement('div');
  div.className = 'thumb';
  div.innerHTML = `
    <img src="${dataUrl}" alt="Page ${page}">
    <div class="meta">Page ${page}<br>${width}×${height}<br><strong style="font-size:.85rem">${name}</strong></div>
    <div style="display:flex;gap:6px;margin-top:6px">
      <a class="btn" download="${name}" href="${dataUrl}" style="padding:6px 8px;border-radius:6px;border:1px solid var(--border);background:transparent">Download</a>
      <button class="btn btn-primary" style="padding:6px 8px;border-radius:6px" data-page="${page}"><i class="fa-solid fa-pen"></i> Edit</button>
    </div>
  `;
  // Edit button placeholder: user may want to open image editor; for now alert
  const editBtn = div.querySelector('.btn-primary');
  editBtn.addEventListener('click', ()=> {
    // As a placeholder, open image in new tab for editing/downloading externally.
    const w = window.open('', '_blank');
    w.document.write(`<title>${name}</title><img src="${dataUrl}" style="max-width:100%;height:auto">`);
  });

  thumbs.appendChild(div);
}

/* Convert dataURL to Blob */
function dataURLToBlob(dataurl){
  const arr = dataurl.split(','), mime = arr[0].match(/:(.*?);/)[1];
  const bstr = atob(arr[1]);
  let n = bstr.length; const u8 = new Uint8Array(n);
  while(n--) u8[n] = bstr.charCodeAt(n);
  return new Blob([u8], { type: mime });
}

/* Download all as ZIP */
downloadAllBtn.addEventListener('click', async ()=>{
  if(!generatedImages.length) return;
  const zip = new JSZip();
  const folder = zip.folder(`${fileName}_images`) || zip;
  for(const img of generatedImages){
    // add blob, use provided file name
    folder.file(img.name, img.blob);
  }
  statusEl.textContent = 'Preparing ZIP...';
  setProgress(6);
  const content = await zip.generateAsync({type:'blob'}, (meta)=>{
    setProgress(6 + meta.percent * 0.9);
  });
  const a = document.createElement('a');
  a.href = URL.createObjectURL(content);
  a.download = `${fileName}_images.zip`;
  document.body.appendChild(a);
  a.click();
  a.remove();
  setTimeout(()=> URL.revokeObjectURL(a.href), 4000);
  statusEl.textContent = 'ZIP download started.';
  setProgress(100);
  setTimeout(()=> setProgress(0), 600);
});

/* Progress helper */
function setProgress(p){ progressBar.style.width = Math.min(100,Math.max(0,Math.round(p))) + '%'; }

/* Small convenience: pressing Enter on pages input triggers convert */
pagesInput.addEventListener('keydown', (e)=> { if(e.key === 'Enter') convertBtn.click(); });

/* Utility: reset view when navigation occurs (optional) */
window.addEventListener('beforeunload', ()=> {/* nothing persisted */});

</script>
</body>
</html>
